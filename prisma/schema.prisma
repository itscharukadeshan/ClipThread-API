generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}
model User {
  id               String     @id @default(uuid())
  twitchId         String?     @unique
  youtubeId        String?     @unique
  login            String?
  displayName      String?
  type             String?
  broadcasterType  String?
  description      String?
  profileImageUrl  String?
  offlineImageUrl  String?
  viewCount        Int?
  email            String?
  createdAt        DateTime?
  followers Int?
  collections Thread[]

  twitchAuth TwitchAuth? 
  youtubeAuth YouTubeAuth?
}

model TwitchAuth {
  id            String     @id @default(uuid())
  user   User @relation(fields: [userId], references: [id])
  userId String  @unique
  accessToken  String @db.VarChar(500)
  refreshToken String @db.VarChar(500)
  expiryTime   DateTime
}

model YouTubeAuth {
  id           String     @id @default(uuid())
  user   User @relation(fields: [userId], references: [id])
  userId String @unique
  accessToken  String @db.VarChar(500) 
  refreshToken String @db.VarChar(500)
  expiryTime   DateTime
}

model Thread {
  id        String     @id @default(uuid())
  user   Clip @relation(fields: [clipId], references: [id])
  clipId String
  title     String
  url   String
  description String? 
  published Boolean @default(false)
  publishedTime DateTime @default(now())
  author    User?   @relation(fields: [authorId], references: [id])
  authorId  String?
}

model Clip {
  id          String     @id @default(uuid())
  description String?
  url String
  tags Tag[]
  threads Thread []
}

model Tag {
 id         String     @id @default(uuid())
  name      String  
  topic     Topic?   @relation(fields: [topicId], references: [id])
  topicId   String? 
  clips   Clip[]
}

model Topic {
 id           String     @id @default(uuid())
  category    String
  tags        Tag[]
}
